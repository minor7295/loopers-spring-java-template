{
  "dashboard": {
    "title": "Resilience4j Circuit Breaker & Bulkhead Dashboard",
    "description": "Circuit Breaker, Bulkhead, Retry 메트릭 모니터링 대시보드",
    "tags": ["resilience4j", "circuit-breaker", "bulkhead", "retry"],
    "timezone": "browser",
    "schemaVersion": 16,
    "version": 1,
    "refresh": "10s",
    "panels": [
      {
        "id": 1,
        "title": "Circuit Breaker State",
        "type": "stat",
        "gridPos": {"h": 8, "w": 6, "x": 0, "y": 0},
        "targets": [
          {
            "expr": "resilience4j_circuitbreaker_state{name=\"paymentGatewayClient\"}",
            "legendFormat": "{{state}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "mappings": [
              {"type": "value", "options": {"0": {"text": "CLOSED", "color": "green"}}, "value": "0"},
              {"type": "value", "options": {"1": {"text": "OPEN", "color": "red"}}, "value": "1"},
              {"type": "value", "options": {"2": {"text": "HALF_OPEN", "color": "yellow"}}, "value": "2"}
            ],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": null, "color": "green"},
                {"value": 1, "color": "yellow"},
                {"value": 2, "color": "red"}
              ]
            },
            "unit": "none"
          }
        }
      },
      {
        "id": 2,
        "title": "Circuit Breaker Calls",
        "type": "graph",
        "gridPos": {"h": 8, "w": 9, "x": 6, "y": 0},
        "targets": [
          {
            "expr": "rate(resilience4j_circuitbreaker_calls_total{name=\"paymentGatewayClient\"}[5m])",
            "legendFormat": "{{kind}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Calls/sec"},
          {"format": "short"}
        ]
      },
      {
        "id": 3,
        "title": "Circuit Breaker Failure Rate",
        "type": "graph",
        "gridPos": {"h": 8, "w": 9, "x": 15, "y": 0},
        "targets": [
          {
            "expr": "resilience4j_circuitbreaker_failure_rate{name=\"paymentGatewayClient\"}",
            "legendFormat": "Failure Rate",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "percentunit", "label": "Failure Rate", "max": 1},
          {"format": "short"}
        ]
      },
      {
        "id": 4,
        "title": "Bulkhead Available Concurrent Calls",
        "type": "stat",
        "gridPos": {"h": 8, "w": 6, "x": 0, "y": 8},
        "targets": [
          {
            "expr": "resilience4j_bulkhead_available_concurrent_calls{name=\"paymentGatewayClient\"}",
            "legendFormat": "Available",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": null, "color": "green"},
                {"value": 5, "color": "yellow"},
                {"value": 0, "color": "red"}
              ]
            },
            "unit": "short"
          }
        }
      },
      {
        "id": 5,
        "title": "Bulkhead Thread Pool Usage",
        "type": "graph",
        "gridPos": {"h": 8, "w": 9, "x": 6, "y": 8},
        "targets": [
          {
            "expr": "resilience4j_bulkhead_max_allowed_concurrent_calls{name=\"paymentGatewayClient\"} - resilience4j_bulkhead_available_concurrent_calls{name=\"paymentGatewayClient\"}",
            "legendFormat": "Used",
            "refId": "A"
          },
          {
            "expr": "resilience4j_bulkhead_available_concurrent_calls{name=\"paymentGatewayClient\"}",
            "legendFormat": "Available",
            "refId": "B"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Concurrent Calls"},
          {"format": "short"}
        ]
      },
      {
        "id": 6,
        "title": "Retry Attempts",
        "type": "graph",
        "gridPos": {"h": 8, "w": 9, "x": 15, "y": 8},
        "targets": [
          {
            "expr": "rate(resilience4j_retry_calls_total{name=\"paymentGatewaySchedulerClient\"}[5m])",
            "legendFormat": "{{kind}}",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Retries/sec"},
          {"format": "short"}
        ]
      },
      {
        "id": 7,
        "title": "Circuit Breaker Slow Calls",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
        "targets": [
          {
            "expr": "rate(resilience4j_circuitbreaker_slow_calls_total{name=\"paymentGatewayClient\"}[5m])",
            "legendFormat": "Slow Calls",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Slow Calls/sec"},
          {"format": "short"}
        ]
      },
      {
        "id": 8,
        "title": "Circuit Breaker Not Permitted Calls",
        "type": "graph",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 16},
        "targets": [
          {
            "expr": "rate(resilience4j_circuitbreaker_calls_total{name=\"paymentGatewayClient\",kind=\"not_permitted\"}[5m])",
            "legendFormat": "Not Permitted (Circuit Open)",
            "refId": "A"
          }
        ],
        "yaxes": [
          {"format": "short", "label": "Calls/sec"},
          {"format": "short"}
        ]
      }
    ],
    "time": {
      "from": "now-15m",
      "to": "now"
    },
    "timepicker": {
      "refresh_intervals": ["5s", "10s", "30s", "1m", "5m", "15m", "30m", "1h", "2h", "1d"]
    }
  }
}
